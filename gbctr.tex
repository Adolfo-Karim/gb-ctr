\include{config}

\ifnum \draft=1
  \documentclass[a4paper, draft, oneside]{memoir}
\else
  \documentclass[a4paper, oneside]{memoir}
\fi

\usepackage[final]{graphicx}
\usepackage[english]{babel}
\usepackage{fontspec}
\usepackage[T1]{fontenc}
\usepackage{charter}
\usepackage{mathpazo}
\usepackage[ttdefault=true]{AnonymousPro}
\usepackage{tabu}
\usepackage{pdflscape}
\usepackage{enumitem}
\usepackage{ccicons}
\usepackage[svgnames,table]{xcolor}
\usepackage{tikz}
\usepackage{tikz-timing}
\usepackage{wrapfig}
\usepackage{float}
\usepackage{minted}
\usepackage{enumitem}
\usepackage[most]{tcolorbox}
\usepackage{fontawesome}
\usepackage{hyperref}
\usepackage[all]{hypcap}

% aliases to support old fontawesome package versions
\providecommand\faArrowCircleDown{\faCircleArrowDown}
\providecommand\faArrowCircleUp{\faCircleArrowUp}
\providecommand\faArrowCircleRight{\faCircleArrowRight}
\providecommand\faArrowCircleLeft{\faCircleArrowLeft}

\usemintedstyle{autumn}

\graphicspath{{images/}}

\include{revision}

\bibliographystyle{plain}

\title{Game Boy: Complete Technical Reference}
\author{gekkio\\ \url{https://gekkio.fi}}
\renewcommand{\maketitlehookd}{
  \begin{center}
    Revision \Revision

    \ifdraftdoc
      DRAFT!
    \fi

    \vfill

    \href{http://creativecommons.org/licenses/by-sa/4.0/}{\Huge \ccbysa}

    This work is licensed under a \href{http://creativecommons.org/licenses/by-sa/4.0/}{Creative Commons Attribution-ShareAlike 4.0 International License}.
  \end{center}
}

\ifdraftdoc
  \makeevenfoot{plain}{}{\thepage}{\textit{DRAFT! \Revision}}
  \makeoddfoot{plain}{\textit{DRAFT! \Revision}}{\thepage}{}
  \makeevenfoot{headings}{}{}{\textit{DRAFT! \Revision}}
  \makeoddfoot{headings}{\textit{DRAFT! \Revision}}{}{}
\fi

\hypersetup{final,unicode=true,pdfborder={0 0 0},bookmarksnumbered=true,pdfpagemode=UseOutlines,pdfauthor=gekkio,pdftitle=\thetitle}

\setlrmarginsandblock{2cm}{2cm}{*}
\setulmarginsandblock{2cm}{2cm}{*}
\checkandfixthelayout

\newtcolorbox{speculation}
{colframe=SteelBlue,colback=Azure,title=\faPuzzlePiece,fonttitle=\small}

\newtcolorbox{caveat}
{colframe=Crimson,colback=MistyRose,title=\faExclamation,fonttitle=\small}

\floatstyle{plaintop}
\newfloat{register}{h}{lor}[chapter]
\floatname{register}{Register}

\begin{document}

\hypersetup{pageanchor=false}

\begin{titlingpage}
  \calccentering{\unitlength}
  \setlength{\droptitle}{80pt}
  \begin{adjustwidth*}{\unitlength}{-\unitlength}
    \maketitle
  \end{adjustwidth*}
\end{titlingpage}

\hypersetup{pageanchor=true}

\tableofcontents

\chapter*{Introduction}

\chapter*{How to read this document}

\begin{speculation}
  This is something that hasn't been verified, but would make a lot of sense.
\end{speculation}

\begin{caveat}
  This explains some caveat about this documentation that you should know.
\end{caveat}

\part{Game Boy CPU and the Sharp LR35902 instruction set}

\part{Game Boy CPU peripherals}

\part{Game Boy game cartridges}

\include{xx-mbc1}

\chapter{MBC2}

TODO.

\chapter{MBC3}

TODO.

\chapter{MBC5}

TODO.

\chapter{MBC6}

TODO.

\chapter{MBC7}

TODO.

\chapter{HuC-1}

TODO.

\chapter{HuC-3}

TODO.

\chapter{MMM01}

TODO.

\chapter{TAMA5}

TODO.

\part*{Appendices}
\addcontentsline{toc}{part}{Appendices}
\phantomsection

\begin{appendices}
\include{xx-opcode-tables}
\include{xx-memory-map}
\end{appendices}

\bibliography{gbctr}

\end{document}
